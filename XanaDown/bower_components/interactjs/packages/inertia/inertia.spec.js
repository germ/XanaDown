import test from '@interactjs/_dev/test/test';
import drag from '@interactjs/actions/drag';
import * as helpers from '@interactjs/core/tests/_helpers';
import inertia from './';
test('inertia', (t) => {
    const { scope, interaction, target, interactable, coords, event, } = helpers.testEnv({ plugins: [inertia, drag] });
    const element = target;
    const modifierChange = 5;
    const testModifier = {
        options: { endOnly: true },
        methods: { set({ coords: modifierCoords }) {
                modifierCoords.x += modifierChange;
                modifierCoords.y += modifierChange;
                modifierCallCount++;
            } },
    };
    let modifierCallCount = 0;
    coords.client = coords.page;
    scope.now = () => coords.timeStamp;
    interactable.draggable({ inertia: true });
    // test inertia without modifiers or throw
    downStartMoveUp({ x: 100, y: 0, dt: 1000 });
    t.notOk(interaction.inertia.active, '{ modifiers: [] } && !thrown: inertia is not activated');
    // test inertia without modifiers and with throw
    downStartMoveUp({ x: 100, y: 0, dt: 10 });
    t.ok(interaction.inertia.active, 'thrown: inertia is activated');
    interactable.draggable({ modifiers: [testModifier] });
    // test inertia with { endOnly: true } modifier and with throw
    downStartMoveUp({ x: 100, y: 0, dt: 10 });
    t.equal(modifierCallCount, 1, '{ endOnly: true } && thrown: modifier is not called from pointerUp');
    t.deepEqual(helpers.getProps(interaction.inertia, ['modifiedXe', 'modifiedYe']), {
        modifiedXe: interaction.inertia.xe + modifierChange,
        modifiedYe: interaction.inertia.ye + modifierChange,
    }, '{ endOnly: true } && thrown: inertia target coords are correct');
    // test smoothEnd with { endOnly: false } modifier
    testModifier.options.endOnly = false;
    downStartMoveUp({ x: 1, y: 0, dt: 1000 });
    t.notOk(interaction.inertia.active, '{ endOnly: false } && !thrown: inertia smoothEnd is not activated');
    t.equal(modifierCallCount, 2, '{ endOnly: false } && !thrown: modifier is called from pointerUp');
    // test smoothEnd with { endOnly: true } modifier
    testModifier.options.endOnly = true;
    downStartMoveUp({ x: 1, y: 0, dt: 1000 });
    t.ok(interaction.inertia.active, '{ endOnly: true } && !thrown: inertia smoothEnd is activated');
    t.equal(modifierCallCount, 1, '{ endOnly: true } && !thrown: modifier is not called from pointerUp');
    interaction.stop();
    t.end();
    function downStartMoveUp({ x, y, dt }) {
        modifierCallCount = 0;
        coords.timeStamp = 0;
        interaction.stop();
        Object.assign(coords.page, { x: 0, y: 0 });
        interaction.pointerDown(event, event, element);
        interaction.start({ name: 'drag' }, interactable, element);
        Object.assign(coords.page, { x, y });
        coords.timeStamp = dt;
        interaction.pointerMove(event, event, element);
        interaction.pointerUp(event, event, element, element);
    }
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5lcnRpYS5zcGVjLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiaW5lcnRpYS5zcGVjLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sSUFBSSxNQUFNLDRCQUE0QixDQUFBO0FBQzdDLE9BQU8sSUFBSSxNQUFNLDBCQUEwQixDQUFBO0FBQzNDLE9BQU8sS0FBSyxPQUFPLE1BQU0saUNBQWlDLENBQUE7QUFDMUQsT0FBTyxPQUFPLE1BQU0sSUFBSSxDQUFBO0FBRXhCLElBQUksQ0FBQyxTQUFTLEVBQUUsQ0FBQyxDQUFDLEVBQUUsRUFBRTtJQUNwQixNQUFNLEVBQ0osS0FBSyxFQUNMLFdBQVcsRUFDWCxNQUFNLEVBQ04sWUFBWSxFQUNaLE1BQU0sRUFDTixLQUFLLEdBQ04sR0FBRyxPQUFPLENBQUMsT0FBTyxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsT0FBTyxFQUFFLElBQUksQ0FBQyxFQUFFLENBQUMsQ0FBQTtJQUNqRCxNQUFNLE9BQU8sR0FBRyxNQUFxQixDQUFBO0lBQ3JDLE1BQU0sY0FBYyxHQUFHLENBQUMsQ0FBQTtJQUN4QixNQUFNLFlBQVksR0FBRztRQUNuQixPQUFPLEVBQUUsRUFBRSxPQUFPLEVBQUUsSUFBSSxFQUFFO1FBQzFCLE9BQU8sRUFBRSxFQUFFLEdBQUcsQ0FBRSxFQUFFLE1BQU0sRUFBRSxjQUFjLEVBQUU7Z0JBQ3hDLGNBQWMsQ0FBQyxDQUFDLElBQUksY0FBYyxDQUFBO2dCQUNsQyxjQUFjLENBQUMsQ0FBQyxJQUFJLGNBQWMsQ0FBQTtnQkFDbEMsaUJBQWlCLEVBQUUsQ0FBQTtZQUNyQixDQUFDLEVBQUU7S0FDSixDQUFBO0lBRUQsSUFBSSxpQkFBaUIsR0FBRyxDQUFDLENBQUE7SUFFekIsTUFBTSxDQUFDLE1BQU0sR0FBRyxNQUFNLENBQUMsSUFBSSxDQUFBO0lBQzNCLEtBQUssQ0FBQyxHQUFHLEdBQUcsR0FBRyxFQUFFLENBQUMsTUFBTSxDQUFDLFNBQVMsQ0FBQTtJQUNsQyxZQUFZLENB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QUFLLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFFOUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxFQUFFLElBQUksRUFBRSxNQUFNLEVBQUUsRUFBRSxZQUFZLEVBQUUsT0FBTyxDQUFDLENBQUE7UUFFMUQsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsSUFBSSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLENBQUE7UUFDcEMsTUFBTSxDQUFDLFNBQVMsR0FBRyxFQUFFLENBQUE7UUFDckIsV0FBVyxDQUFDLFdBQVcsQ0FBQyxLQUFLLEVBQUUsS0FBSyxFQUFFLE9BQU8sQ0FBQyxDQUFBO1FBQzlDLFdBQVcsQ0FBQyxTQUFTLENBQUMsS0FBSyxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsT0FBTyxDQUFDLENBQUE7SUFDdkQsQ0FBQztBQUNILENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHRlc3QgZnJvbSAnQGludGVyYWN0anMvX2Rldi90ZXN0L3Rlc3QnXG5pbXBvcnQgZHJhZyBmcm9tICdAaW50ZXJhY3Rqcy9hY3Rpb25zL2RyYWcnXG5pbXBvcnQgKiBhcyBoZWxwZXJzIGZyb20gJ0BpbnRlcmFjdGpzL2NvcmUvdGVzdHMvX2hlbHBlcnMnXG5pbXBvcnQgaW5lcnRpYSBmcm9tICcuLydcblxudGVzdCgnaW5lcnRpYScsICh0KSA9PiB7XG4gIGNvbnN0IHtcbiAgICBzY29wZSxcbiAgICBpbnRlcmFjdGlvbixcbiAgICB0YXJnZXQsXG4gICAgaW50ZXJhY3RhYmxlLFxuICAgIGNvb3JkcyxcbiAgICBldmVudCxcbiAgfSA9IGhlbHBlcnMudGVzdEVudih7IHBsdWdpbnM6IFtpbmVydGlhLCBkcmFnXSB9KVxuICBjb25zdCBlbGVtZW50ID0gdGFyZ2V0IGFzIEhUTUxFbGVtZW50XG4gIGNvbnN0IG1vZGlmaWVyQ2hhbmdlID0gNVxuICBjb25zdCB0ZXN0TW9kaWZpZXIgPSB7XG4gICAgb3B0aW9uczogeyBlbmRPbmx5OiB0cnVlIH0sXG4gICAgbWV0aG9kczogeyBzZXQgKHsgY29vcmRzOiBtb2RpZmllckNvb3JkcyB9KSB7XG4gICAgICBtb2RpZmllckNvb3Jkcy54ICs9IG1vZGlmaWVyQ2hhbmdlXG4gICAgICBtb2RpZmllckNvb3Jkcy55ICs9IG1vZGlmaWVyQ2hhbmdlXG4gICAgICBtb2RpZmllckNhbGxDb3VudCsrXG4gICAgfSB9LFxuICB9XG5cbiAgbGV0IG1vZGlmaWVyQ2FsbENvdW50ID0gMFxuXG4gIGNvb3Jkcy5jbGllbnQgPSBjb29yZHMucGFnZVxuICBzY29wZS5ub3cgPSAoKSA9PiBjb29yZHMudGltZVN0YW1wXG4gIGludGVyYWN0YWJsZS5kcmFnZ2FibGUoeyBpbmVydGlhOiB0cnVlIH0pXG5cbiAgLy8gdGVzdCBpbmVydGlhIHdpdGhvdXQgbW9kaWZpZXJzIG9yIHRocm93XG4gIGRvd25TdGFydE1vdmVVcCh7IHg6IDEwMCwgeTogMCwgZHQ6IDEwMDAgfSlcbiAgdC5ub3RPayhpbnRlcmFjdGlvbi5pbmVydGlhLmFjdGl2ZSwgJ3sgbW9kaWZpZXJzOiBbXSB9ICYmICF0aHJvd246IGluZXJ0aWEgaXMgbm90IGFjdGl2YXRlZCcpXG5cbiAgLy8gdGVzdCBpbmVydGlhIHdpdGhvdXQgbW9kaWZpZXJzIGFuZCB3aXRoIHRocm93XG4gIGRvd25TdGFydE1vdmVVcCh7IHg6IDEwMCwgeTogMCwgZHQ6IDEwIH0pXG4gIHQub2soaW50ZXJhY3Rpb24uaW5lcnRpYS5hY3RpdmUsICd0aHJvd246IGluZXJ0aWEgaXMgYWN0aXZhdGVkJylcblxuICBpbnRlcmFjdGFibGUuZHJhZ2dhYmxlKHsgbW9kaWZpZXJzOiBbdGVzdE1vZGlmaWVyIGFzIGFueV0gfSlcblxuICAvLyB0ZXN0IGluZXJ0aWEgd2l0aCB7IGVuZE9ubHk6IHRydWUgfSBtb2RpZmllciBhbmQgd2l0aCB0aHJvd1xuICBkb3duU3RhcnRNb3ZlVXAoeyB4OiAxMDAsIHk6IDAsIGR0OiAxMCB9KVxuICB0LmVxdWFsKG1vZGlmaWVyQ2FsbENvdW50LCAxLCAneyBlbmRPbmx5OiB0cnVlIH0gJiYgdGhyb3duOiBtb2RpZmllciBpcyBub3QgY2FsbGVkIGZyb20gcG9pbnRlclVwJylcbiAgdC5kZWVwRXF1YWwoXG4gICAgaGVscGVycy5nZXRQcm9wcyhpbnRlcmFjdGlvbi5pbmVydGlhLCBbJ21vZGlmaWVkWGUnLCAnbW9kaWZpZWRZZSddKSxcbiAgICB7XG4gICAgICBtb2RpZmllZFhlOiBpbnRlcmFjdGlvbi5pbmVydGlhLnhlICsgbW9kaWZpZXJDaGFuZ2UsXG4gICAgICBtb2RpZmllZFllOiBpbnRlcmFjdGlvbi5pbmVydGlhLnllICsgbW9kaWZpZXJDaGFuZ2UsXG4gICAgfSxcbiAgICAneyBlbmRPbmx5OiB0cnVlIH0gJiYgdGhyb3duOiBpbmVydGlhIHRhcmdldCBjb29yZHMgYXJlIGNvcnJlY3QnKVxuXG4gIC8vIHRlc3Qgc21vb3RoRW5kIHdpdGggeyBlbmRPbmx5OiBmYWxzZSB9IG1vZGlmaWVyXG4gIHRlc3RNb2RpZmllci5vcHRpb25zLmVuZE9ubHkgPSBmYWxzZVxuICBkb3duU3RhcnRNb3ZlVXAoeyB4OiAxLCB5OiAwLCBkdDogMTAwMCB9KVxuICB0Lm5vdE9rKGludGVyYWN0aW9uLmluZXJ0aWEuYWN0aXZlLCAneyBlbmRPbmx5OiBmYWxzZSB9ICYmICF0aHJvd246IGluZXJ0aWEgc21vb3RoRW5kIGlzIG5vdCBhY3RpdmF0ZWQnKVxuICB0LmVxdWFsKG1vZGlmaWVyQ2FsbENvdW50LCAyLCAneyBlbmRPbmx5OiBmYWxzZSB9ICYmICF0aHJvd246IG1vZGlmaWVyIGlzIGNhbGxlZCBmcm9tIHBvaW50ZXJVcCcpXG5cbiAgLy8gdGVzdCBzbW9vdGhFbmQgd2l0aCB7IGVuZE9ubHk6IHRydWUgfSBtb2RpZmllclxuICB0ZXN0TW9kaWZpZXIub3B0aW9ucy5lbmRPbmx5ID0gdHJ1ZVxuICBkb3duU3RhcnRNb3ZlVXAoeyB4OiAxLCB5OiAwLCBkdDogMTAwMCB9KVxuICB0Lm9rKGludGVyYWN0aW9uLmluZXJ0aWEuYWN0aXZlLCAneyBlbmRPbmx5OiB0cnVlIH0gJiYgIXRocm93bjogaW5lcnRpYSBzbW9vdGhFbmQgaXMgYWN0aXZhdGVkJylcbiAgdC5lcXVhbChtb2RpZmllckNhbGxDb3VudCwgMSwgJ3sgZW5kT25seTogdHJ1ZSB9ICYmICF0aHJvd246IG1vZGlmaWVyIGlzIG5vdCBjYWxsZWQgZnJvbSBwb2ludGVyVXAnKVxuXG4gIGludGVyYWN0aW9uLnN0b3AoKVxuICB0LmVuZCgpXG5cbiAgZnVuY3Rpb24gZG93blN0YXJ0TW92ZVVwICh7IHgsIHksIGR0IH0pIHtcbiAgICBtb2RpZmllckNhbGxDb3VudCA9IDBcbiAgICBjb29yZHMudGltZVN0YW1wID0gMFxuICAgIGludGVyYWN0aW9uLnN0b3AoKVxuXG4gICAgT2JqZWN0LmFzc2lnbihjb29yZHMucGFnZSwgeyB4OiAwLCB5OiAwIH0pXG4gICAgaW50ZXJhY3Rpb24ucG9pbnRlckRvd24oZXZlbnQsIGV2ZW50LCBlbGVtZW50KVxuXG4gICAgaW50ZXJhY3Rpb24uc3RhcnQoeyBuYW1lOiAnZHJhZycgfSwgaW50ZXJhY3RhYmxlLCBlbGVtZW50KVxuXG4gICAgT2JqZWN0LmFzc2lnbihjb29yZHMucGFnZSwgeyB4LCB5IH0pXG4gICAgY29vcmRzLnRpbWVTdGFtcCA9IGR0XG4gICAgaW50ZXJhY3Rpb24ucG9pbnRlck1vdmUoZXZlbnQsIGV2ZW50LCBlbGVtZW50KVxuICAgIGludGVyYWN0aW9uLnBvaW50ZXJVcChldmVudCwgZXZlbnQsIGVsZW1lbnQsIGVsZW1lbnQpXG4gIH1cbn0pXG4iXX0=