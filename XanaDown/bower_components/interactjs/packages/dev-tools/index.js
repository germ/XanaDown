/* eslint-disable no-console */
/* global process */
import domObjects from '@interactjs/utils/domObjects';
import { parentNode } from '@interactjs/utils/domUtils';
import extend from '@interactjs/utils/extend';
import * as is from '@interactjs/utils/is';
import win from '@interactjs/utils/window';
var CheckName;
(function (CheckName) {
    CheckName["touchAction"] = "";
    CheckName["boxSizing"] = "";
    CheckName["noListeners"] = "";
})(CheckName || (CheckName = {}));
const prefix = '[interact.js] ';
const links = {
    touchAction: 'https://developer.mozilla.org/en-US/docs/Web/CSS/touch-action',
    boxSizing: 'https://developer.mozilla.org/en-US/docs/Web/CSS/box-sizing',
};
const isProduction = process.env.NODE_ENV === 'production';
// eslint-disable-next-line no-restricted-syntax
function install(scope, { logger } = {}) {
    const { interactions, Interactable, defaults, } = scope;
    logger = logger || console;
    interactions.signals.on('action-start', ({ interaction }) => {
        for (const check of checks) {
            const options = interaction.interactable && interaction.interactable.options[interaction.prepared.name];
            if (!(options && options.devTools && options.devTools.ignore[check.name]) &&
                check.perform(interaction)) {
                logger.warn(prefix + check.text, ...check.getInfo(interaction));
            }
        }
    });
    defaults.base.devTools = {
        ignore: {},
    };
    Interactable.prototype.devTools = function (options) {
        if (options) {
            extend(this.options.devTools, options);
            return this;
        }
        return this.options.devTools;
    };
}
const checks = [
    {
        name: 'touchAction',
        perform({ element }) {
            return !parentHasStyle(element, 'touchAction', /pan-|pinch|none/);
        },
        getInfo({ element }) {
            return [
                element,
                links.touchAction,
            ];
        },
        text: 'Consider adding CSS "touch-action: none" to this element\n',
    },
    {
        name: 'boxSizing',
        perform(interaction) {
            const { element } = interaction;
            return interaction.prepared.name === 'resize' &&
                element instanceof domObjects.HTMLElement &&
                !hasStyle(element, 'boxSizing', /border-box/);
        },
        text: 'Consider adding CSS "box-sizing: border-box" to this resizable element',
        getInfo({ element }) {
            return [
                element,
                links.boxSizing,
            ];
        },
    },
    {
        name: 'noListeners',
        perform(interaction) {
            const actionName = interaction.prepared.name;
            const moveListeners = interaction.interactable.events.types[`${actionName}move`] || [];
            return !moveListeners.length;
        },
        getInfo(interaction) {
            return [
                interaction.prepared.name,
                interaction.interactable,
            ];
        },
        text: 'There are no listeners set for this action',
    },
];
function hasStyle(element, prop, styleRe) {
    return styleRe.test(element.style[prop] || win.window.getComputedStyle(element)[prop]);
}
function parentHasStyle(element, prop, styleRe) {
    let parent = element;
    while (is.element(parent)) {
        if (hasStyle(parent, prop, styleRe)) {
            return true;
        }
        parent = parentNode(parent);
    }
    return false;
}
const id = 'dev-tools';
const defaultExport = isProduction
    ? { id, install: () => { } }
    : {
        id,
        install,
        checks,
        CheckName,
        links,
        prefix,
    };
export default defaultExport;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW5kZXguanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJpbmRleC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSwrQkFBK0I7QUFDL0Isb0JBQW9CO0FBQ3BCLE9BQU8sVUFBVSxNQUFNLDhCQUE4QixDQUFBO0FBQ3JELE9BQU8sRUFBRSxVQUFVLEVBQUUsTUFBTSw0QkFBNEIsQ0FBQTtBQUN2RCxPQUFPLE1BQU0sTUFBTSwwQkFBMEIsQ0FBQTtBQUM3QyxPQUFPLEtBQUssRUFBRSxNQUFNLHNCQUFzQixDQUFBO0FBQzFDLE9BQU8sR0FBRyxNQUFNLDBCQUEwQixDQUFBO0FBcUMxQyxJQUFLLFNBSUo7QUFKRCxXQUFLLFNBQVM7SUFDWiw2QkFBZ0IsQ0FBQTtJQUNoQiwyQkFBYyxDQUFBO0lBQ2QsNkJBQWdCLENBQUE7QUFDbEIsQ0FBQyxFQUpJLFNBQVMsS0FBVCxTQUFTLFFBSWI7QUFFRCxNQUFNLE1BQU0sR0FBSSxnQkFBZ0IsQ0FBQTtBQUNoQyxNQUFNLEtBQUssR0FBRztJQUNaLFdBQVcsRUFBRSwrREFBK0Q7SUFDNUUsU0FBUyxFQUFFLDZEQUE2RDtDQUN6RSxDQUFBO0FBRUQsTUFBTSxZQUFZLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFRLEtBQUssWUFBWSxDQUFBO0FBRTFELGdEQUFnRDtBQUNoRCxTQUFTLE9BQU8sQ0FBRSxLQUFxQixFQUFFLEVBQUUsTUFBTSxLQUEwQixFQUFFO0lBQzNFLE1BQU0sRUFDSixZQUFZLEVBQ1osWUFBWSxFQUNaLFFBQVEsR0FDVCxHQUFHLEtBQUssQ0FBQTtJQUNULE1BQU0sR0FBRyxNQUFNLElBQUksT0FBTyxDQUFBO0lBRTFCLFlBQVksQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLGNBQWMsRUFBRSxDQUFDLEVBQUUsV0FBVyxFQUFFLEVBQUUsRUFBRTtRQUMxRCxLQUFLLE1BQU0sS0FBSyxJQUFJLE1BQU0sRUFBRTtZQUMxQixNQUFNLE9BQU8sR0FBRyxXQUFXLENBQUMsWUFBWSxJQUFJ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QyxJQUFJLENBQUMsQ0FBQyxDQUFBO0FBQ3hGLENBQUM7QUFFRCxTQUFTLGNBQWMsQ0FBRSxPQUFnQixFQUFFLElBQStCLEVBQUUsT0FBZTtJQUN6RixJQUFJLE1BQU0sR0FBRyxPQUFzQixDQUFBO0lBRW5DLE9BQU8sRUFBRSxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsRUFBRTtRQUN6QixJQUFJLFFBQVEsQ0FBQyxNQUFNLEVBQUUsSUFBSSxFQUFFLE9BQU8sQ0FBQyxFQUFFO1lBQ25DLE9BQU8sSUFBSSxDQUFBO1NBQ1o7UUFFRCxNQUFNLEdBQUcsVUFBVSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0tBQzVCO0lBRUQsT0FBTyxLQUFLLENBQUE7QUFDZCxDQUFDO0FBRUQsTUFBTSxFQUFFLEdBQUcsV0FBVyxDQUFBO0FBQ3RCLE1BQU0sYUFBYSxHQUFHLFlBQVk7SUFDaEMsQ0FBQyxDQUFDLEVBQUUsRUFBRSxFQUFFLE9BQU8sRUFBRSxHQUFHLEVBQUUsR0FBRSxDQUFDLEVBQUU7SUFDM0IsQ0FBQyxDQUFDO1FBQ0EsRUFBRTtRQUNGLE9BQU87UUFDUCxNQUFNO1FBQ04sU0FBUztRQUNULEtBQUs7UUFDTCxNQUFNO0tBQ1AsQ0FBQTtBQUVILGVBQWUsYUFBYSxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiLyogZXNsaW50LWRpc2FibGUgbm8tY29uc29sZSAqL1xuLyogZ2xvYmFsIHByb2Nlc3MgKi9cbmltcG9ydCBkb21PYmplY3RzIGZyb20gJ0BpbnRlcmFjdGpzL3V0aWxzL2RvbU9iamVjdHMnXG5pbXBvcnQgeyBwYXJlbnROb2RlIH0gZnJvbSAnQGludGVyYWN0anMvdXRpbHMvZG9tVXRpbHMnXG5pbXBvcnQgZXh0ZW5kIGZyb20gJ0BpbnRlcmFjdGpzL3V0aWxzL2V4dGVuZCdcbmltcG9ydCAqIGFzIGlzIGZyb20gJ0BpbnRlcmFjdGpzL3V0aWxzL2lzJ1xuaW1wb3J0IHdpbiBmcm9tICdAaW50ZXJhY3Rqcy91dGlscy93aW5kb3cnXG5cbmRlY2xhcmUgbW9kdWxlICdAaW50ZXJhY3Rqcy9jb3JlL3Njb3BlJyB7XG4gIGludGVyZmFjZSBTY29wZSB7XG4gICAgbG9nZ2VyOiBMb2dnZXJcbiAgfVxufVxuXG5kZWNsYXJlIG1vZHVsZSAnQGludGVyYWN0anMvY29yZS9kZWZhdWx0T3B0aW9ucycge1xuICBpbnRlcmZhY2UgQmFzZURlZmF1bHRzIHtcbiAgICBkZXZUb29scz86IERldlRvb2xzT3B0aW9uc1xuICB9XG59XG5cbmRlY2xhcmUgbW9kdWxlICdAaW50ZXJhY3Rqcy9jb3JlL0ludGVyYWN0YWJsZScge1xuICBpbnRlcmZhY2UgSW50ZXJhY3RhYmxlIHtcbiAgICBkZXZUb29scz86IEludGVyYWN0Lk9wdGlvbk1ldGhvZDxEZXZUb29sc09wdGlvbnM+XG4gIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBEZXZUb29sc09wdGlvbnMge1xuICBpZ25vcmU6IHsgW1AgaW4ga2V5b2YgdHlwZW9mIENoZWNrTmFtZV0/OiBib29sZWFuIH1cbn1cblxuZXhwb3J0IGludGVyZmFjZSBMb2dnZXIge1xuICB3YXJuOiAoLi4uYXJnczogYW55W10pID0+IHZvaWRcbiAgZXJyb3I6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZFxuICBsb2c6ICguLi5hcmdzOiBhbnlbXSkgPT4gdm9pZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIENoZWNrIHtcbiAgbmFtZTogc3RyaW5nXG4gIHRleHQ6IHN0cmluZ1xuICBwZXJmb3JtOiAoaW50ZXJhY3Rpb246IEludGVyYWN0LkludGVyYWN0aW9uKSA9PiBib29sZWFuXG4gIGdldEluZm86IChpbnRlcmFjdGlvbjogSW50ZXJhY3QuSW50ZXJhY3Rpb24pID0+IGFueVtdXG59XG5cbmVudW0gQ2hlY2tOYW1lIHtcbiAgdG91Y2hBY3Rpb24gPSAnJyxcbiAgYm94U2l6aW5nID0gJycsXG4gIG5vTGlzdGVuZXJzID0gJycsXG59XG5cbmNvbnN0IHByZWZpeCAgPSAnW2ludGVyYWN0LmpzXSAnXG5jb25zdCBsaW5rcyA9IHtcbiAgdG91Y2hBY3Rpb246ICdodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9DU1MvdG91Y2gtYWN0aW9uJyxcbiAgYm94U2l6aW5nOiAnaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4tVVMvZG9jcy9XZWIvQ1NTL2JveC1zaXppbmcnLFxufVxuXG5jb25zdCBpc1Byb2R1Y3Rpb24gPSBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nXG5cbi8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1yZXN0cmljdGVkLXN5bnRheFxuZnVuY3Rpb24gaW5zdGFsbCAoc2NvcGU6IEludGVyYWN0LlNjb3BlLCB7IGxvZ2dlciB9OiB7IGxvZ2dlcj86IExvZ2dlciB9ID0ge30pIHtcbiAgY29uc3Qge1xuICAgIGludGVyYWN0aW9ucyxcbiAgICBJbnRlcmFjdGFibGUsXG4gICAgZGVmYXVsdHMsXG4gIH0gPSBzY29wZVxuICBsb2dnZXIgPSBsb2dnZXIgfHwgY29uc29sZVxuXG4gIGludGVyYWN0aW9ucy5zaWduYWxzLm9uKCdhY3Rpb24tc3RhcnQnLCAoeyBpbnRlcmFjdGlvbiB9KSA9PiB7XG4gICAgZm9yIChjb25zdCBjaGVjayBvZiBjaGVja3MpIHtcbiAgICAgIGNvbnN0IG9wdGlvbnMgPSBpbnRlcmFjdGlvbi5pbnRlcmFjdGFibGUgJiYgaW50ZXJhY3Rpb24uaW50ZXJhY3RhYmxlLm9wdGlvbnNbaW50ZXJhY3Rpb24ucHJlcGFyZWQubmFtZV1cblxuICAgICAgaWYgKFxuICAgICAgICAhKG9wdGlvbnMgJiYgb3B0aW9ucy5kZXZUb29scyAmJiBvcHRpb25zLmRldlRvb2xzLmlnbm9yZVtjaGVjay5uYW1lXSkgJiZcbiAgICAgICAgY2hlY2sucGVyZm9ybShpbnRlcmFjdGlvbilcbiAgICAgICkge1xuICAgICAgICBsb2dnZXIud2FybihwcmVmaXggKyBjaGVjay50ZXh0LCAuLi5jaGVjay5nZXRJbmZvKGludGVyYWN0aW9uKSlcbiAgICAgIH1cbiAgICB9XG4gIH0pXG5cbiAgZGVmYXVsdHMuYmFzZS5kZXZUb29scyA9IHtcbiAgICBpZ25vcmU6IHt9LFxuICB9XG5cbiAgSW50ZXJhY3RhYmxlLnByb3RvdHlwZS5kZXZUb29scyA9IGZ1bmN0aW9uIChvcHRpb25zPykge1xuICAgIGlmIChvcHRpb25zKSB7XG4gICAgICBleHRlbmQodGhpcy5vcHRpb25zLmRldlRvb2xzLCBvcHRpb25zKVxuICAgICAgcmV0dXJuIHRoaXNcbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcy5vcHRpb25zLmRldlRvb2xzXG4gIH1cbn1cblxuY29uc3QgY2hlY2tzOiBDaGVja1tdID0gW1xuICB7XG4gICAgbmFtZTogJ3RvdWNoQWN0aW9uJyxcbiAgICBwZXJmb3JtICh7IGVsZW1lbnQgfSkge1xuICAgICAgcmV0dXJuICFwYXJlbnRIYXNTdHlsZShlbGVtZW50LCAndG91Y2hBY3Rpb24nLCAvcGFuLXxwaW5jaHxub25lLylcbiAgICB9LFxuICAgIGdldEluZm8gKHsgZWxlbWVudCB9KSB7XG4gICAgICByZXR1cm4gW1xuICAgICAgICBlbGVtZW50LFxuICAgICAgICBsaW5rcy50b3VjaEFjdGlvbixcbiAgICAgIF1cbiAgICB9LFxuICAgIHRleHQ6ICdDb25zaWRlciBhZGRpbmcgQ1NTIFwidG91Y2gtYWN0aW9uOiBub25lXCIgdG8gdGhpcyBlbGVtZW50XFxuJyxcbiAgfSxcblxuICB7XG4gICAgbmFtZTogJ2JveFNpemluZycsXG4gICAgcGVyZm9ybSAoaW50ZXJhY3Rpb24pIHtcbiAgICAgIGNvbnN0IHsgZWxlbWVudCB9ID0gaW50ZXJhY3Rpb25cblxuICAgICAgcmV0dXJuIGludGVyYWN0aW9uLnByZXBhcmVkLm5hbWUgPT09ICdyZXNpemUnICYmXG4gICAgICAgIGVsZW1lbnQgaW5zdGFuY2VvZiBkb21PYmplY3RzLkhUTUxFbGVtZW50ICYmXG4gICAgICAgICFoYXNTdHlsZShlbGVtZW50LCAnYm94U2l6aW5nJywgL2JvcmRlci1ib3gvKVxuICAgIH0sXG4gICAgdGV4dDogJ0NvbnNpZGVyIGFkZGluZyBDU1MgXCJib3gtc2l6aW5nOiBib3JkZXItYm94XCIgdG8gdGhpcyByZXNpemFibGUgZWxlbWVudCcsXG4gICAgZ2V0SW5mbyAoeyBlbGVtZW50IH0pIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGVsZW1lbnQsXG4gICAgICAgIGxpbmtzLmJveFNpemluZyxcbiAgICAgIF1cbiAgICB9LFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiAnbm9MaXN0ZW5lcnMnLFxuICAgIHBlcmZvcm0gKGludGVyYWN0aW9uKSB7XG4gICAgICBjb25zdCBhY3Rpb25OYW1lID0gaW50ZXJhY3Rpb24ucHJlcGFyZWQubmFtZVxuICAgICAgY29uc3QgbW92ZUxpc3RlbmVycyA9IGludGVyYWN0aW9uLmludGVyYWN0YWJsZS5ldmVudHMudHlwZXNbYCR7YWN0aW9uTmFtZX1tb3ZlYF0gfHwgW11cblxuICAgICAgcmV0dXJuICFtb3ZlTGlzdGVuZXJzLmxlbmd0aFxuICAgIH0sXG4gICAgZ2V0SW5mbyAoaW50ZXJhY3Rpb24pIHtcbiAgICAgIHJldHVybiBbXG4gICAgICAgIGludGVyYWN0aW9uLnByZXBhcmVkLm5hbWUsXG4gICAgICAgIGludGVyYWN0aW9uLmludGVyYWN0YWJsZSxcbiAgICAgIF1cbiAgICB9LFxuICAgIHRleHQ6ICdUaGVyZSBhcmUgbm8gbGlzdGVuZXJzIHNldCBmb3IgdGhpcyBhY3Rpb24nLFxuICB9LFxuXVxuXG5mdW5jdGlvbiBoYXNTdHlsZSAoZWxlbWVudDogSFRNTEVsZW1lbnQsIHByb3A6IGtleW9mIENTU1N0eWxlRGVjbGFyYXRpb24sIHN0eWxlUmU6IFJlZ0V4cCkge1xuICByZXR1cm4gc3R5bGVSZS50ZXN0KGVsZW1lbnQuc3R5bGVbcHJvcF0gfHwgd2luLndpbmRvdy5nZXRDb21wdXRlZFN0eWxlKGVsZW1lbnQpW3Byb3BdKVxufVxuXG5mdW5jdGlvbiBwYXJlbnRIYXNTdHlsZSAoZWxlbWVudDogRWxlbWVudCwgcHJvcDoga2V5b2YgQ1NTU3R5bGVEZWNsYXJhdGlvbiwgc3R5bGVSZTogUmVnRXhwKSB7XG4gIGxldCBwYXJlbnQgPSBlbGVtZW50IGFzIEhUTUxFbGVtZW50XG5cbiAgd2hpbGUgKGlzLmVsZW1lbnQocGFyZW50KSkge1xuICAgIGlmIChoYXNTdHlsZShwYXJlbnQsIHByb3AsIHN0eWxlUmUpKSB7XG4gICAgICByZXR1cm4gdHJ1ZVxuICAgIH1cblxuICAgIHBhcmVudCA9IHBhcmVudE5vZGUocGFyZW50KVxuICB9XG5cbiAgcmV0dXJuIGZhbHNlXG59XG5cbmNvbnN0IGlkID0gJ2Rldi10b29scydcbmNvbnN0IGRlZmF1bHRFeHBvcnQgPSBpc1Byb2R1Y3Rpb25cbiAgPyB7IGlkLCBpbnN0YWxsOiAoKSA9PiB7fSB9XG4gIDoge1xuICAgIGlkLFxuICAgIGluc3RhbGwsXG4gICAgY2hlY2tzLFxuICAgIENoZWNrTmFtZSxcbiAgICBsaW5rcyxcbiAgICBwcmVmaXgsXG4gIH1cblxuZXhwb3J0IGRlZmF1bHQgZGVmYXVsdEV4cG9ydFxuIl19